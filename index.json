[{"content":"Como Engenheiro DevOps, minha paix√£o √© otimizar processos e impulsionar a melhoria cont√≠nua, buscando constantemente novas abordagens para elevar a efici√™ncia, escalabilidade e confiabilidade em ambientes de produ√ß√£o. Meu compromisso √© entregar resultados de alta qualidade visando otimizar fluxos de trabalho e gerar resultados tang√≠veis para o neg√≥cio.\nGraduado em Ci√™ncias da Computa√ß√£o pela Uniruy Wyden, tenho mais de 12 anos de experi√™ncia como analista de infraestrutura e opera√ß√µes de TI, atuando com equipes multidisciplinares, desenvolvendo solu√ß√µes para os desafios organizacionais, onde pude desenvolver habilidades como: colabora√ß√£o, comunica√ß√£o, resili√™ncia, proatividade, pensamento cr√≠tico, dentre outras.\nMinha expertise t√©cnica abrange um ecossistema de tecnologias modernas, incluindo:\nContainers: Docker e Kubernetes CI/CD: GitLab CI Cloud Computing: AWS e Oracle Cloud Gerenciamento de Configura√ß√£o: Ansible Infraestrutura como C√≥digo (IaC): Terraform Versionamento: Git, Github e GitLab Monitoramento e Observabilidade: Zabbix, Prometheus e Grafana Sistemas Operacionais: Linux e Windows Servidores Web: IIS, Apache e Nginx Certifica√ß√µes:\nCertified Kubernetes Administrator (CKA); AWS Cloud Practitioner; GitLab Certified Associate; ITIL IT Service Management v4. Espero que possa te ajudar tamb√©m. ü§ì\n","permalink":"https://rbsantosbr.github.io/sobre/","summary":"\u003cp\u003eComo Engenheiro DevOps, minha paix√£o √© otimizar processos e impulsionar a melhoria cont√≠nua, buscando constantemente novas abordagens para elevar a efici√™ncia, escalabilidade e confiabilidade em ambientes de produ√ß√£o. Meu compromisso √© entregar resultados de alta qualidade visando otimizar fluxos de trabalho e gerar resultados tang√≠veis para o neg√≥cio.\u003c/p\u003e\n\u003cp\u003eGraduado em Ci√™ncias da Computa√ß√£o pela Uniruy Wyden, tenho mais de 12 anos de experi√™ncia como analista de infraestrutura e opera√ß√µes de TI, atuando com equipes multidisciplinares, desenvolvendo solu√ß√µes para os desafios organizacionais, onde pude desenvolver habilidades como: colabora√ß√£o, comunica√ß√£o, resili√™ncia, proatividade, pensamento cr√≠tico, dentre outras.\u003c/p\u003e","title":"Sobre"},{"content":"Fala pessoal,\nRecentemente me deparei com o desafio de coletar as m√©tricas de um equipamento via protocolo SNMP, e exp√¥r essas m√©tricas no Prometheus/ Grafana. Como solu√ß√£o encontrei o componente snmp_exporter, que permite a coleta das m√©tricas em dispositivos via protocolo SNMP e convertem no modelo de dados utilizado pelo Prometheus.\nNeste post vamos aprender a extrair m√©tricas customizadas a partir de uma Base de Gerenciamento de informa√ß√µes (Management Information Base - MIB) SNMP, criar um arquivo de configura√ß√£o snmp.yml para a coleta de m√©tricas pelo snmp_exporter, e exp√¥r essas m√©tricas no prometheus.\nRequisitos Host linux; Docker; Bin√°rio golang. Instala√ß√£o Clone o repositorio do snmp_exporter:\ngit clone https://github.com/prometheus/snmp_exporter.git Instale as depend√™ncias de acordo com o seu sistema operacional e em seguida compile o generator:\n# Debian-based distributions. sudo apt-get install -y unzip build-essential libsnmp-dev # Redhat-based distributions. sudo yum install -y gcc make net-snmp net-snmp-utils net-snmp-libs net-snmp-devel # Compilar o generator cd snmp_exporter/generator make generator mibs Ap√≥s a compila√ß√£o podemos visualizar, no diret√≥rio atual, o bin√°rio generator e o arquivo snmp.yml rec√©m criados.\nCaso a compila√ß√£o apresente algum erro por falta de MIBs, neste reposit√≥rio voc√™ pode encontrar MIBs de diversos fabricantes.\nConfigura√ß√£o Neste exemplo utilizei a MIB de um nobreak UPS. Recomendo que utilize um equipamento de sua prefer√™ncia e sua(s) respectiva(s) MIB(s) para reproduzir este cen√°rio.\nEdite o arquivo generator.yml e adicione as credenciais, ajustando a comunidade e vers√£o SNMP conforme necess√°rio:\nauths: public_v1: community: public security_level: noAuthNoPriv auth_protocol: MD5 priv_protocol: DES version: 1 Ainda no arquivo generator, ap√≥s definir quais as m√©tricas ser√£o utilizadas, crie uma nova entrada de m√≥dulo:\nmodules: teste: walk: - nome - ups - modeloUps - vin - vout - perBateria - temperatura Adicione o arquivo *.mib de refer√™ncia no diret√≥rio mibs. Este arquivo ser√° utilizado pelo generator para mapear as m√©tricas configuradas no passo anterior, traduzi-l√°s para o respectivo OID, e atualizar o arquivo snmp.yml;\nExecute o comando ./generator -m mibs/ generate. Este comando ir√° atualizar o arquivo snmp.yml com as novas configura√ß√µes. Ap√≥s finaliza√ß√£o do processo, √© poss√≠vel validar as m√©tricas rec√©m adicionadas:\nteste: get: - 1.3.6.1.4.1.28802.1.1.0 - 1.3.6.1.4.1.28802.2.1.1.0 - 1.3.6.1.4.1.28802.2.1.2.0 - 1.3.6.1.4.1.28802.2.2.1.0 - 1.3.6.1.4.1.28802.2.2.2.0 - 1.3.6.1.4.1.28802.2.2.5.0 - 1.3.6.1.4.1.28802.2.2.6.0 metrics: - name: nome oid: 1.3.6.1.4.1.28802.1.1 type: DisplayString help: nome do produto - 1.3.6.1.4.1.28802.1.1 - name: ups oid: 1.3.6.1.4.1.28802.2.1.1 type: DisplayString help: tipo de UPS - 1.3.6.1.4.1.28802.2.1.1 - name: modeloUps oid: 1.3.6.1.4.1.28802.2.1.2 type: DisplayString help: modelo do UPS - 1.3.6.1.4.1.28802.2.1.2 - name: vin oid: 1.3.6.1.4.1.28802.2.2.1 type: gauge help: Tensao de entrada - 1.3.6.1.4.1.28802.2.2.1 - name: vout oid: 1.3.6.1.4.1.28802.2.2.2 type: gauge help: Tensao de saida - 1.3.6.1.4.1.28802.2.2.2 - name: perBateria oid: 1.3.6.1.4.1.28802.2.2.5 type: gauge help: Porcentagem da carga de bateria - 1.3.6.1.4.1.28802.2.2.5 - name: temperatura oid: 1.3.6.1.4.1.28802.2.2.6 type: gauge help: Temperatura - 1.3.6.1.4.1.28802.2.2.6 Validando as configura√ß√µes - TL;DR Para validar as configura√ß√µes, utilizei uma stack do docker compose, contendo os servi√ßos snmp_exporter, prometheus e grafana. Todos os arquivos utilizados neste post est√£o no meu reposit√≥rio.\nAbaixo seguem prints p√≥s configura√ß√£o.\nSNMP Exporter:\nM√©tricas capturadas pelo exporter:\nM√©tricas do exporter inseridas no Prometheus:\nM√©tricas dispon√≠veis no grafana ap√≥s configura√ß√£o do datasource.\nDados transformados em informa√ß√µes no Grafana: Espero ter ajudado, At√© breve!\n","permalink":"https://rbsantosbr.github.io/posts/criando-metricas-personalizadas-para-o-prometheus-snmp-exporter/","summary":"\u003cp\u003eFala pessoal,\u003cbr\u003e\nRecentemente me deparei com o desafio de coletar as m√©tricas de um equipamento via protocolo SNMP, e exp√¥r essas m√©tricas no Prometheus/ Grafana. Como solu√ß√£o encontrei o componente snmp_exporter, que permite a coleta das m√©tricas em dispositivos via protocolo SNMP e convertem no modelo de dados utilizado pelo Prometheus.\u003c/p\u003e\n\u003cp\u003eNeste post vamos aprender a extrair m√©tricas customizadas a partir de uma Base de Gerenciamento de informa√ß√µes (Management Information Base - MIB) SNMP, criar um arquivo de configura√ß√£o snmp.yml para a coleta de m√©tricas pelo snmp_exporter, e exp√¥r essas m√©tricas no prometheus.\u003c/p\u003e","title":"Criando m√©tricas personalizadas para o Prometheus com o SNMP Exporter"},{"content":"O Proxmox Virtual Environment, comunmente chamado de proxmox, √© uma plataforma de virtualiza√ß√£o de c√≥digo aberto, que permite a cria√ß√£o e gerenciamento de m√°quinas virtuais e/ou cont√™neres, atrav√©s da sua interface intuitiva e amig√°vel.\nO Terraform provider bpg/proxmox possui a capacidade de controlar diversos recursos desta plataforma, como por exemplo, usu√°rios, roles, upload de arquivos, snippets, vlans, etc.\nNeste primeiro post veremos como fazer a configura√ß√£o deste provider, criando um usu√°rio com as credenciais necess√°rias para gerenciar os recursos do proxmox, atrav√©s do terraform.\nPr√©-requisitos Terraform 0.13+\nProxmox Virtual Environment - vers√£o utilizada: 8.2.2\nEditor da sua prefer√™ncia.\nEstrutura do projeto Utilize os comandos abaixo para criar a estrutura necess√°ria para o projeto:\nmkdir -p proxmox touch ./proxmox/{main,providers,outputs,variables}.tf touch ./proxmox/credentials.auto.tfvars Ap√≥s a cria√ß√£o, o diret√≥rio ficar√° assim:\nConfigurando o provider Inicialmente edite o arquivo providers.tf, adicionando os blocos de c√≥digo abaixo:\nterraform { required_providers { proxmox = { source = \u0026#34;bpg/proxmox\u0026#34; version = \u0026#34;0.68.0\u0026#34; } } required_version = \u0026#34;\u0026gt;= 0.13\u0026#34; } provider \u0026#34;proxmox\u0026#34; { endpoint = var.endpoint username = var.username password = var.password # Habilite esta op√ß√£o caso n√£o possua um certificado v√°lido. #insecure = true ssh { agent = true } } O bloco de c√≥digo terraform define, dentre outros, todos os plugins necess√°rios para a cria√ß√£o e gerenciamento de recursos definidos no projeto. J√° o bloco provider, estabelece como vamos interagir com o proxmox.\nPara mais detalhes sobre o provider bpg/proxmox clique aqui.\nDefini√ß√£o das vari√°veis As vari√°veis do terraform permitem customizar os recursos de forma din√¢mica, tornando o c√≥digo reutiliz√°vel.\nDepois da configura√ß√£o do provider, edite o arquivo variables.tf e adicione as defini√ß√µes das vari√°veis:\nvariable \u0026#34;endpoint\u0026#34; { type = string description = \u0026#34;Endere√ßo da API do proxmox\u0026#34; } variable \u0026#34;username\u0026#34; { type = string description = \u0026#34;usuario do proxmox\u0026#34; } variable \u0026#34;password\u0026#34; { type = string description = \u0026#34;senha do usuario proxmox\u0026#34; } No arquivo credencial.auto.tfvars adicione os valores das respectivas vari√°veis no esquema \u0026ldquo;chave=valor\u0026rdquo;.\nendpoint = \u0026#34;https://\u0026lt;ip_do_servidor_proxmox\u0026gt;:8006\u0026#34; username = \u0026#34;superuser@pam\u0026#34; password = \u0026#34;superUserPassword\u0026#34; Os valores das vari√°veis definidos em arquivos *.auto.tfvars, s√£o automaticamente carregados durante a execu√ß√£o do c√≥digo terraform.\nInicializando o projeto Realizadas todas as configura√ß√µes, execute o comando terraform init para que o terraform fa√ßa o download e instala√ß√£o do provider. A sa√≠da do comando ser√° semelhante a esta:\nGerenciando os recursos Faremos a configura√ß√£o de tr√™s recursos do proxmox via terraform. Ser√£o eles:\nRole: Define o conjunto privil√©gios que executam fun√ß√µes espec√≠ficas dentro do proxmox; User: Um novo usu√°rio que ser√° associado a role rec√©m-criada; Token: Um token de api para o novo usu√°rio, em substitui√ß√£o ao par√¢metro password. Edite o arquivo main.tf e adicione o seguinte conte√∫do:\nresource \u0026#34;proxmox_virtual_environment_role\u0026#34; \u0026#34;terraform\u0026#34; { role_id = \u0026#34;BPG-Terraform\u0026#34; privileges = [ \u0026#34;Datastore.Allocate\u0026#34;, \u0026#34;Datastore.AllocateSpace\u0026#34;, \u0026#34;Datastore.AllocateTemplate\u0026#34;, \u0026#34;Datastore.Audit\u0026#34;, \u0026#34;Permissions.Modify\u0026#34;, \u0026#34;Pool.Allocate\u0026#34;, \u0026#34;Realm.AllocateUser\u0026#34;, \u0026#34;Sys.Audit\u0026#34;, \u0026#34;Sys.Console\u0026#34;, \u0026#34;Sys.Modify\u0026#34;, \u0026#34;SDN.Use\u0026#34;, \u0026#34;VM.Allocate\u0026#34;, \u0026#34;VM.Audit\u0026#34;, \u0026#34;VM.Clone\u0026#34;, \u0026#34;VM.Config.CDROM\u0026#34;, \u0026#34;VM.Config.Cloudinit\u0026#34;, \u0026#34;VM.Config.CPU\u0026#34;, \u0026#34;VM.Config.Disk\u0026#34;, \u0026#34;VM.Config.HWType\u0026#34;, \u0026#34;VM.Config.Memory\u0026#34;, \u0026#34;VM.Config.Network\u0026#34;, \u0026#34;VM.Config.Options\u0026#34;, \u0026#34;VM.Migrate\u0026#34;, \u0026#34;VM.Monitor\u0026#34;, \u0026#34;VM.PowerMgmt\u0026#34;, \u0026#34;User.Modify\u0026#34;, ] } resource \u0026#34;proxmox_virtual_environment_user\u0026#34; \u0026#34;pve_user\u0026#34; { acl { path = \u0026#34;/\u0026#34; propagate = true role_id = proxmox_virtual_environment_role.terraform.role_id } comment = \u0026#34;Managed by Terraform\u0026#34; user_id = \u0026#34;proxmox-post@pve\u0026#34; } resource \u0026#34;proxmox_virtual_environment_user_token\u0026#34; \u0026#34;pve_user_token\u0026#34; { comment = \u0026#34;Managed by Terraform\u0026#34; expiration_date = \u0026#34;2024-12-10T00:30:00Z\u0026#34; # Altere a data de expira√ß√£o do token, ou comente esta linha para desativar a expira√ß√£o do token. privileges_separation = false token_name = \u0026#34;terraform\u0026#34; user_id = proxmox_virtual_environment_user.pve_user.user_id } No arquivo outputs.tf, adicione as entradas abaixo:\noutput \u0026#34;id\u0026#34; { value = proxmox_virtual_environment_user_token.pve_user_token.id } output \u0026#34;api_token\u0026#34; { value = proxmox_virtual_environment_user_token.pve_user_token.value sensitive = true } Aplique as configura√ß√µes utilizando os comandos terraform plan e terraform apply\nAgora verifique os recursos rec√©m criados no proxmox. O API token √© classificado como uma informa√ß√£o sens√≠vel e o terraform possui diversos mecanismos para evitar o vazamento deste dado. Para recuperar o valor do token execute o comando terraform output -raw api-token. Para validar o token, atualize os arquivos providers, variables e credentials.auto.tfvars respectivamente, conforme exemplo abaixo.\n# main.tf provider \u0026#34;proxmox\u0026#34; { endpoint = var.endpoint api_token = var.api_token # username = var.username # password = var.password # Habilite esta op√ß√£o caso n√£o possua um certificado v√°lido. #insecure = true ssh { agent = true } } # variables.tf variable \u0026#34;api_token\u0026#34; { type = string description = \u0026#34;token para autentica√ß√£o. Substitui username e password.\u0026#34; } # credentials.auto.tfvars api_token = \u0026#34;proxmox-post@pve!terraform=448...\u0026#34; Agora voc√™ tem um usu√°rio para gerenciar os recursos do proxmox atrav√©s do terraform.\nReposit√≥rio dos artefatos utilizados neste post.\nAt√© breve! ü§ì\n","permalink":"https://rbsantosbr.github.io/posts/gerenciando-recursos-do-proxmox-com-o-terraform/","summary":"\u003cp\u003eO Proxmox Virtual Environment, comunmente chamado de proxmox, √© uma plataforma de virtualiza√ß√£o de c√≥digo aberto, que permite a cria√ß√£o e gerenciamento de m√°quinas virtuais e/ou cont√™neres, atrav√©s da sua interface intuitiva e amig√°vel.\u003c/p\u003e\n\u003cp\u003eO \u003cem\u003eTerraform provider\u003c/em\u003e \u003cstrong\u003ebpg/proxmox\u003c/strong\u003e possui a capacidade de controlar diversos recursos desta plataforma, como por exemplo, usu√°rios, roles, upload de arquivos, snippets, vlans, etc.\u003c/p\u003e\n\u003cp\u003eNeste primeiro post veremos como fazer a configura√ß√£o deste provider, criando um usu√°rio com as credenciais necess√°rias para gerenciar os recursos do proxmox, atrav√©s do terraform.\u003c/p\u003e","title":"Gerenciando recursos do Proxmox com o Terraform"}]